{"version":3,"sources":["icons/index.js","icons/svg sync nonrecursive //.svg$","icons/svg/icon_alert.svg","App.tsx","common/config/localeConfig.ts","i18n/locales/en/index.js","i18n/locales/zh-CN/index.js","i18n.js","common/utils/lang.js","index.tsx"],"names":["requireContext","req","require","keys","map","webpackContext","id","webpackContextResolve","__webpack_require__","o","e","Error","code","Object","resolve","module","exports","symbol","add","App","props","state","getData","ele","callback","Promise","reject","result","names","files","forEach","item","index","reader","FileReader","console","log","name","push","readAsBinaryString","originFileObj","onerror","evt","alert","onload","target","length","error","generateDocument","origin","document","getElementById","data","fileList","message","workbook","XLSX","type","sheet","Sheets","prototype","hasOwnProperty","call","concat","sheet_to_json","mid","setState","slice","outs","PizZip","folder","zip","doc","Docxtemplater","paragraphLoop","linebreaks","setData","prePeopleFee","Number","toFixed","preDirectFee","preLongFee","preOtherFee","preMount","infactPeopleFee","infactDirectFee","infactLongFee","infactOtherFee","infactMount","render","out","getZip","generate","mimeType","saveAs","className","style","display","width","height","justifyContent","alignItems","accept","marginLeft","marginBottom","marginTop","onChange","info","directory","beforeUpload","this","textAlign","onClick","React","Component","LOCALES_MAP","key","text","antdLocale","zhCN","enUS","locale","common","backendProps","backend","loadPath","i18n","use","LanguageDetector","initReactI18next","init","resources","en","debug","supportedLngs","fallbackLng","ns","defaultNS","lng","userSettingLang","localStorage","getItem","defaultLang","browserLang","navigator","language","userLanguage","filterLangs","filter","includes","getBrowserSettingLangMap","getElementsByTagName","lang","setItem","getDefaultLang","load","interpolation","escapeValue","ReactDOM","createRoot"],"mappings":"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","file":"static/js/main.d63151e1.chunk.js","sourcesContent":["const req = require.context('./svg', false, /\\.svg$/);\nconst requireAll = (requireContext) =>\n  requireContext.keys().map(requireContext);\nrequireAll(req);\n","var map = {\n\t\"./icon_alert.svg\": 287\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 286;","import SpriteSymbol from \"../../../node_modules/svg-baker-runtime/browser-symbol.js\";\nimport sprite from \"../../../node_modules/svg-sprite-loader/runtime/browser-sprite.build.js\";\nvar symbol = new SpriteSymbol({\n  \"id\": \"icon_alert\",\n  \"use\": \"icon_alert-usage\",\n  \"viewBox\": \"0 0 16 16\",\n  \"content\": \"<symbol viewBox=\\\"0 0 16 16\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" id=\\\"icon_alert\\\">\\n  <g fill=\\\"none\\\" fill-rule=\\\"evenodd\\\">\\n    <path d=\\\"M8.832 2.248l6.132 9.197A1 1 0 0 1 14.13 13H1.87a1 1 0 0 1-.833-1.555l6.132-9.197a1 1 0 0 1 1.664 0z\\\" fill=\\\"currentColor\\\" />\\n    <path d=\\\"M8.456 9.23l.16-4.295a.674.674 0 0 0-.674-.7.667.667 0 0 0-.666.7l.207 4.295a.49.49 0 0 0 .49.466c.26 0 .474-.206.483-.466zM8 11.86a.765.765 0 0 0 .528-.204.696.696 0 0 0 .204-.516.687.687 0 0 0-.204-.504.714.714 0 0 0-.528-.204.687.687 0 0 0-.516.204.644.644 0 0 0-.204.504c0 .204.06.372.204.516A.736.736 0 0 0 8 11.86z\\\" fill=\\\"#FFF\\\" fill-rule=\\\"nonzero\\\" />\\n  </g>\\n</symbol>\"\n});\nvar result = sprite.add(symbol);\nexport default symbol","import React, { Component } from 'react';\n\nimport Docxtemplater from 'docxtemplater';\nimport PizZip from 'pizzip';\nimport PizZipUtils from 'pizzip/utils/index.js';\nimport { saveAs } from 'file-saver';\nimport { Button, Input, message, Upload } from 'antd';\nimport * as XLSX from 'xlsx';\nconst App = class App extends React.Component {\n  state: any;\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: [],\n      fileList: [],\n    };\n  }\n  getData = async (ele, callback?) => {\n    return new Promise((resolve, reject) => {\n      const result: any = [];\n      const names: any[] = [];\n      ele.files.forEach((item, index) => {\n        const reader = new FileReader();\n        console.log(ele.files[index].name, 1111);\n        names.push(ele.files[index].name);\n        reader.readAsBinaryString(\n          ele.files[index]?.originFileObj\n            ? ele.files[index]?.originFileObj\n            : ele.files[index],\n        );\n        reader.onerror = function (evt) {\n          console.log('error reading file', evt);\n          alert('error reading file' + evt);\n        };\n        reader.onload = (evt: any) => {\n          try {\n            result.push(evt.target.result);\n            if (result.length === ele.files.length) {\n              callback({ target: { result } }, names);\n            }\n\n            resolve(1);\n          } catch (error) {\n            console.log(error);\n            reject(1);\n            // The error thrown here contains additional information when logged with JSON.stringify (it contains a properties object containing all suberrors).\n          }\n        };\n      });\n    });\n  };\n  generateDocument = async () => {\n    const origin: any = document.getElementById('origin');\n    if (!this.state.data || this.state.fileList.length === 0) {\n      message.error('请确认数据或者模板已上传');\n      return;\n    }\n    await this.getData({ files: [origin.files[0]] }, (evt) => {\n      const workbook = XLSX.read(evt.target.result[0], { type: 'binary' });\n      let data = []; // 存储获取到的数据\n      // 遍历每张工作表进行读取（这里默认只读取第一张表）\n      for (const sheet in workbook.Sheets) {\n        if (Object.prototype.hasOwnProperty.call(workbook.Sheets, sheet)) {\n          //这是关键的一步，hasOwnPropert要从Object的原型中调用\n          // 利用 sheet_to_json 方法将 excel 转成 json 数据\n          data = data.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));\n          // break; // 如果只取第一张表，就取消注释这行\n        }\n      }\n      const mid = data.length / 2;\n      this.setState({ data: [data.slice(0, mid), data.slice(mid + 1)] });\n    });\n    await this.getData({ files: this.state.fileList }, (evt, names) => {\n      const result = new PizZip();\n      const outs = result.folder('result');\n      this.state?.data[0].forEach((item, index) => {\n        if (!evt.target.result[index]) {\n          return;\n        }\n        const zip = new PizZip(evt.target.result[index]);\n        const doc = new Docxtemplater(zip, {\n          paragraphLoop: true,\n          linebreaks: true,\n        });\n        doc.setData({\n          prePeopleFee:\n            Number(this.state?.data[0][index]['人员人工'])?.toFixed(2) ||\n            '0.00',\n          preDirectFee:\n            Number(this.state?.data[0][index]['直接投入'])?.toFixed(2) ||\n            '0.00',\n          preLongFee:\n            Number(this.state?.data[0][index]['折旧摊销'])?.toFixed(2) ||\n            '0.00',\n          preOtherFee:\n            Number(this.state?.data[0][index]['其他费用'])?.toFixed(2) ||\n            '0.00',\n          preMount:\n            Number(this.state?.data[0][index]['内部研发费总额'])?.toFixed(2) ||\n            '0.00',\n          infactPeopleFee:\n            Number(this.state?.data[1][index]['人员人工'])?.toFixed(2) ||\n            '0.00',\n          infactDirectFee:\n            Number(this.state?.data[1][index]['直接投入'])?.toFixed(2) ||\n            '0.00',\n          infactLongFee:\n            Number(this.state?.data[1][index]['折旧摊销'])?.toFixed(2) ||\n            '0.00',\n          infactOtherFee:\n            Number(this.state?.data[1][index]['其他费用'])?.toFixed(2) ||\n            '0.00',\n          infactMount:\n            Number(this.state?.data[1][index]['内部研发费总额'])?.toFixed(2) ||\n            '0.00',\n        });\n        // render the document (replace all occurences of {first_name} by John, {last_name} by Doe, ...)\n        doc.render();\n        const out = doc.getZip().generate({\n          type: 'blob',\n          mimeType:\n            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        }); //Output the document using Data-URI\n\n        saveAs(out, names[index]);\n      });\n\n      console.log(outs, 111);\n    });\n  };\n  render() {\n    return (\n      <div\n        className=\"App\"\n        style={{\n          display: 'flex',\n          width: '100%',\n          height: '500px',\n          justifyContent: 'center',\n          alignItems: 'center',\n        }}\n      >\n        <div>\n          <div>\n            选择数据源(xlsx) :\n            <Input\n              accept=\"xlsx\"\n              style={{ width: 200, marginLeft: 30 }}\n              id=\"origin\"\n              type={'file'}\n            ></Input>\n          </div>\n          <div style={{ marginBottom: 20, marginTop: 20 }}>\n            选择模版文件(docx) :\n            <Upload\n              onChange={(info) => {\n                this.setState({ fileList: info.fileList });\n              }}\n              directory\n              id=\"doc\"\n              beforeUpload={() => false}\n              fileList={this.state.fileList}\n            >\n              <Button style={{ marginLeft: 10 }}>上传文件夹</Button>\n            </Upload>\n          </div>\n          <div style={{ textAlign: 'center' }}>\n            <Button type=\"primary\" onClick={this.generateDocument}>\n              生成文档\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n};\nexport default App;\n","import zhCN from 'antd/lib/locale-provider/zh_CN';\nimport enUS from 'antd/lib/locale-provider/en_US';\n\nexport const LOCALES_MAP = {\n  'zh-CN': {\n    key: 'zh-CN',\n    text: '简体中文',\n    antdLocale: zhCN,\n  },\n  'en-US': {\n    key: 'en',\n    text: 'English',\n    antdLocale: enUS,\n  },\n};\n","import common from './common.json';\nconst locale = {\n  common,\n};\n\nexport default locale;\n","import common from './common.json';\nconst locale = {\n  common,\n};\n\nexport default locale;\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\nimport { getDefaultLang } from 'common/utils/lang';\nimport en from 'i18n/locales/en';\nimport zhCN from 'i18n/locales/zh-CN';\nconst backendProps =\n  process.env.NODE_ENV === 'production'\n    ? {\n        backend: { loadPath: `/locales/{{lng}}/{{ns}}.json` },\n      }\n    : null;\n\nconst supportLanguages = ['en', 'zh-CN'];\n\ni18n\n  // .use(Backend)\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  // for all options read: https://www.i18next.com/overview/configuration-options\n  .init({\n    resources: {\n      en,\n      'zh-CN': zhCN,\n    },\n    debug: false,\n    supportedLngs: supportLanguages,\n    fallbackLng: 'en',\n    ns: ['common'],\n    defaultNS: 'common',\n    lng: getDefaultLang(),\n    load: 'currentOnly',\n    interpolation: {\n      escapeValue: false, // not needed for react as it escapes by default\n    },\n    ...backendProps,\n  });\n\nexport default i18n;\n","import { LOCALES_MAP } from 'common/config/localeConfig';\nconst getBrowserSettingLangMap = () => {\n  let browserLang = navigator.language || navigator.userLanguage;\n\n  const filterLangs = Object.keys(LOCALES_MAP).filter(\n    (item) => !browserLang.includes(item),\n  );\n  if (filterLangs && filterLangs.length > 0) {\n    return LOCALES_MAP[filterLangs[0]].key;\n  }\n\n  return 'en';\n};\n\nconst getDefaultLang = () => {\n  let userSettingLang = localStorage.getItem('lang');\n  let defaultLang = userSettingLang || getBrowserSettingLangMap();\n  document.getElementsByTagName('html')[0].lang = defaultLang;\n  if (userSettingLang) {\n    // 重置localStorage 中的lang 将 en-US 等替换为 en, zh-CN zh-HK 保持不变\n    localStorage.setItem('lang', defaultLang);\n  }\n  return defaultLang;\n};\n\nexport { getDefaultLang };\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport './index.scss';\nimport App from './App';\nimport \"./i18n.js\"\nimport './icons';\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\n\nroot.render(\n\n  <Router>\n    <App />\n  </Router>\n\n\n);\n\n\n"],"sourceRoot":""}